{% extends 'base.html.twig' %}

{% block title %} {{ parent() }} - Boutique en ligne {% endblock %}
{% block stylesheets %} 
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
{{ parent() }} 
{% endblock %}

{% block body %}
 <!--Message-->
  {% for category, messages in app.flashes %}
      {% for message in messages %}
          <div class=" w-50 container-sm alert alert-{{ category }}">
          <button type="button" class="btn-close float-end" data-bs-dismiss="alert"></button>
              {{ message }}
          </div>
      {% endfor %}
  {% endfor %}
  <h1 class="titre">La Boutique</h1>

  <!--Carousel-->
  <h2 class="titre">Vins de la semaine</h2>
  <div id="carouselExampleCaptions" class="carousel slide sk-container sk-carousel">
    <div class="carousel-indicators">
      {% for vin in vins %}
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="{{ loop.index0 }}" {% if loop.first %}class="active" aria-current="true"{% endif %} aria-label="Slide {{ loop.index }}"></button>
      {% endfor %}
    </div>
    <div class="carousel-inner">
      {% for vin in vins %}
        <div class="carousel-item {% if loop.first %}active{% endif %}">
          <div class="d-flex align-items-center justify-content-center">
            <img src="{{ vich_uploader_asset(vin) }}" class="d-block w-50" alt="{{ vin.nom }}">
            <div class="d-none d-md-block d-flex align-items-center justify-content-center">
              <h5 class="text-center w-50">{{ vin.region }} - {{ vin.millesime }}</h5>
              <p class="text-center w-50">{{ vin.description }}</p>
              <button class="sk-button" onclick="addToCart('{{ vin.id }}')">Ajouter au panier</button>
              <div class="sk-quantity">
                <label for="quantity_{{vin.id}}">Quantité:</label>
                <input class="quantity_{{ vin.id }}" type="number" name="quantity" min="1" value="1" onchange="updateQuantity('{{ vin.id }}', this.value)">
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
    <button class="carousel-control-prev sk-button-slide" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next sk-button-slide" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <div class="sk-divider"></div>
  
<!--Card-->
<div class="d-flex column-gap-3 sk-container">
  {% for vin in vins %}
  <a href="#">
    <div class="card sk-card text-center">
      <img class="sk-picture" src="{{ vich_uploader_asset(vin) }}" alt="{{ vin.nom }}">
      <div class="sk-cardbody">
        <h5 class="card-title sk-card-title mt-3">{{vin.nom}}</h5>
        <p class="card-text sk-card-title">{{vin.region}} - {{vin.millesime}}</p>
        <p class="card-text sk-card-title">{{vin.couleur}}</p>
        <p class="card-text sk-card-title">{{vin.prix}} €</p>
        <button class="sk-button" onclick="addToCart('{{ vin.id }}')">Ajouter au panier</button>
        <div class="sk-quantity">
          <label for="quantity_{{vin.id}}">Quantité:</label>
          <input class="quantity_{{ vin.id }}" type="number" name="quantity" min="1" value="1" onchange="updateQuantity('{{ vin.id }}', this.value)">
        </div>
      </div>
    </div>
  </a>
  {% endfor %}
</div>

<script>
function addToCart(id) {
  var quantityInput = document.querySelector('.quantity_' + id);
  var quantity = parseInt(quantityInput.value);
  var url = "{{ path('shop_add', { 'id': 'VIN_ID', 'quantity': 'QUANTITY' }) }}";
  url = url.replace('VIN_ID', id);
  url = url.replace('QUANTITY', quantity);
  window.location.href = url;
}

function updateQuantity(id, value) {
  var quantityInput = document.querySelector('.quantity_' + id);
  quantityInput.value = value;
}
</script>


{% block javascripts %} {{ parent()}}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
{% endblock %}

{% endblock %}
